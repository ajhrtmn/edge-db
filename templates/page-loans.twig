{% extends "base.twig" %}

{% block content %}

<style>
    /*
    #loan_list > div > div {
        padding: 1rem;
    }
    #total_results > div > div {
        padding: 1rem;
    }
    */
</style>

<div class="w-full edge-loans-bg hero">
    <div class="left-offset diag bg-white w-7/12 py-20 flex justify-end">
        <div class="flex flex-col justify-end pr-16">
            <div class="flex gap-6 edge-max-w-500">
                <div class="edge-bg-red diag px-6"></div>
                <div class="search-header bebas mt-8">SEARCH THE PROJECT DATABASE</div>
            </div>
            <div class="flex gap-6 mt-4 justify-end">
				<div class="">
					<input id="name-search" type="text" placeholder="Enter search terms here" class="edge-bg-lite text-sm p-2 diag">
				</div>
				<div>
					<button id="search-button" class="text-sm text-white edge-btn-red py-2 px-12 diag">SEARCH</button>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="edge-bg-lite py-8">
    <div class="edge-wrapper">
        <h1 class="flex gap-6 flex items-center sm-hdr">
            <div class="px-2 py-8 edge-bg-red diag"></div>
            <div>Loan Data</div>
        <h1>
    </div>
</div>

<div id="edge_loans" class="">
    Loading...
</div>

<div class="edge-wrapper mt-24">
    <h1 class="my-8 flex gap-6 flex items-center sm-hdr">
        <div class="px-2 py-8 edge-bg-red diag"></div>
        <div>Loans Program<br>Impact</div>
    <h1>
</div>

<div id="total_results" class="edge-wrapper flex flex-col mb-24 overflow-x-auto">
    Loading...
</div>

<script>
    const URL = SITE_URL + '/loans/loan/';

    const total_jobs = loans.map(function (l) {
        return parseInt(l.ProjectedNewJobs);
    });

    const total_capital_investment = loans.map(function (l) {
        return parseInt(l.TotalProjectedCapitalInvestment);
    });

    const total_number_of_loans = loans.length;

    const total_amount_of_loans = loans.map(function (l) {
        return parseInt(l.LoanAmount);
    });

    html = `
        <div class="flex flex-col">
            <div class="overflow-x-auto">
                <div class="inline-block min-w-full">
                    <div class="overflow-x-auto">
                        <table class="max-w-screen-xl mx-auto">
                        <thead class="text-base text-center">
                            <tr>
                            <th scope="col" class="px-6 py-4 text-left">
                                Total Jobs
                            </th>
                            <th scope="col" class="px-6 py-4 text-left max-w-xs">
                                Total Capital Investment
                            </th>
                            <th scope="col" class="px-6 py-4 text-left">
                                Total Number of Loans
                            </th>
                            <th scope="col" class="px-6 py-4 text-left">
                                Total Amount of Loans
                            </th>
                            </tr>
                        </thead>
                        <tbody class="text-center">
                            <tr class="row-b1">
                                <td class="px-6 py-4">${total_jobs.reduce((a, b) => a + b)}</td>
                                <td class="px-6 py-4">${formatter.format(total_capital_investment.reduce((a, b) => a + b))}</td>
                                <td class="px-6 py-4">${total_number_of_loans}</td>
                                <td class="px-6 py-4">${formatter.format(total_amount_of_loans.reduce((a, b) => a + b))}</td>               
                            </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>`;

    document.getElementById('total_results').innerHTML = html;

    $(document).ready(function() {
        $('#menu-4').css('color', '#BF021C');
    });

</script>

{% include 'loan-filter.twig' %}

{% endblock %}